<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #playState_left_div{width: 50%;height: 596px;background-color: white;
            border: 1px solid wheat;float: left;}
        #playState_height_div{width: 49.5%;height: 596px;background-color: white;
            border: 1px solid wheat;float: left;}
        .tips{border:1px solid #ccc;font-weight: bolder;font-size: 14px;height: 30px;}
        table{ table-layout:fixed; border-collapse:collapse;text-align: center;}
        tbody {height:500px;display: block;overflow-y:auto;width: 100%;table-layout: fixed;}
        tr {display: table;width: 100%; table-layout: fixed;}
        td{ font-size: 12px;height: 30px; white-space:nowrap;overflow:hidden;text-overflow: ellipsis;}
        tr.on td{ background-color: #BFEFFF; / 背景颜色/}
        #paging_ul{list-style: none;margin: auto;padding: 0px;padding-left: 100px;padding-top: 7px;}
        #paging_ul li{display: inline;float:left;width: 80px;}
        #nextPage{margin-left: -32px;}
    </style>
    <script src="/js/sweetalert.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
</head>
<body>
<div id="playState_left_div">
    <table width="100%" border="0" id="planListTable">
        <thead>
        <tr>
            <th class="tips">预案名称</th>
            <th class="tips">备注</th>
        </tr>
        </thead>
        <tr>
            <td></td>
        </tr>
    </table>
    <div id="paging_div">
        <ul id="paging_ul">
        </ul>
    </div>
</div>
<div id="playState_height_div">
    <table width="100%" border="0" id="planContentTable">
        <thead>
        <tr>
            <th class="tips">播放控制器编号</th>
            <th class="tips">文件名称</th>
            <th class="tips">状态</th>
            <th class="tips">下载百分比</th>
        </tr>
        </thead>
        <tr>
            <td></td>
        </tr>
    </table>
</div>
<script language="JavaScript" src="/js/jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    selectPlayList();
    $("#planListTable tbody tr").live("click",function(){ //给每个tr 绑定点击事件 主要锁定每个tr
        var trs = $(this).parent().find('tr'); //获取所有tr
        if(trs.hasClass('on')){ //判断这些tr 有没有Class ‘on’’
            trs.removeClass('on');//把class on 移除
        }
        $(this).addClass('on');//点击的tr 添加 on class 用于改变样式
        var playListID=$(this).closest("tr").find("td").eq(0).text();
        $.ajax({
            url:'/downloadStatus/selectDownload',
            type:"POST",
            data:{playListID:playListID},
            success:function (data) {
                $("#planContentTable tbody tr").remove();
                $.each(data.pageUtil.pageData, function (i, item) {
                    $("#planContentTable tbody").prepend('<tr><td hidden="hidden">'+item.id+'</td>' +
                        '<td>'+item.playlistID+'</td>' +
                        '<td>'+item.fileName+'</td>' +
                        '<td>'+item.status+'</td>' +
                        '<td>'+item.percen+'</td></tr>');
                });
            }
        });
    });
});

function selectPlayList(pageNum) {
    var timeLength=0;
    $.ajax({
        url:'/playList/selectPlayList',
        type:"POST",
        data:{timeLength:timeLength,pageNum:pageNum},
        success:function (data) {
            $("#planListTable tbody tr").remove();
            $.each(data.pageUtil.pageData, function (i, item) {
                $("#planListTable tbody").prepend('<tr><td hidden="hidden">'+item.id+'</td>'+
                    '<td>'+item.name+'</td>'+
                    '<td>'+item.note+'</td>');
            });
            $("#paging_ul li").remove();
            $("#paging_ul").prepend('<li><span>当前页数:</span></li>' +
                '<li><span>'+data.pageUtil.pageNum+'</span>/<span>'+data.pageUtil.maxPage+'</span></li>');
            if(data.pageUtil.pageNum>=2){
                $(".notPreviousPage").remove();
                $("#paging_ul").prepend('<li><input type="button" value="上一页" class="isPreviousPage" onclick="previousPage('+data.pageUtil.pageNum+')"></li>');
            }else{
                $(".isPreviousPage").remove();
                $("#paging_ul").prepend('<li><input type="button" value="上一页" class="notPreviousPage" disabled="disabled"></li>');
            }

            if(data.pageUtil.pageNum<data.pageUtil.maxPage){
                $(".notNextPage").remove();
                $("#paging_ul").append('<li><input type="button" value="下一页" class="isNextPage" id="nextPage" onclick="nextPage('+data.pageUtil.pageNum+')"></li>');
            }else{
                $(".isNextPage").remove();
                $("#paging_ul").append('<li><input type="button" value="下一页" class="notNextPage" id="nextPage" disabled="disabled"></li>');
            }
        }
    });
}

function nextPage(pageNum) {
    var num=parseInt(pageNum)+1;
    selectPlayList(num);
}
function previousPage(pageNum) {
    var num=parseInt(pageNum)-1;
    selectPlayList(num);
}
</script>
</body>
</html>