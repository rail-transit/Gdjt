<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Document</title>
    <style>
        *{
            margin:0px;
            padding: 0px;
        }
        #div1{
            width: 80px;
            height: 110px;
            background: #e9e7e7;
            /*opacity: 0;*/
            position: absolute;
            display: none;
        }
        #div1 ul li{
            list-style: none;
            height: 20px;
            text-align: center;
            line-height: 25px;
            margin-top: 5px;
            cursor:pointer;
            -webkit-transition-duration: 0.5s;
            transition-duration: 0.5s;
            -moz-webkit-transition-duration:0.5s;
        }
        #div1 ul li:hover{
            background: #d6e4d6;
            color: #ffffff;
        }
        img{
            width:100%;
            height:91%;
            max-width:100%;
            max-height:91%;
        }
        .video{height: 33%;width: 33%;background-color: rebeccapurple;
            border: 1px solid red;float: left}
        .footer{width: 100%;height: 9%;margin: auto;padding: 0px;border: 1px solid red;
            border-right: 0px;border-left: 0px;border-bottom: 0px;align-items: center;justify-content: center;
            display: flex;}
        .footer span{font-size: 12px;padding-right: 15px;color: white;}
        .play{
            width: 18px;
            height: 16px;
            background-image: url("/images/play.jpg");
            background-size: 120px 113px;
            border: 0px;
            background-position: -51px -9px;
            border-radius: 8px;}
        .del{
            width: 17px;
            height: 16px;
            background-image: url("/images/play.jpg");
            background-size: 120px 113px;
            border: 0px;
            background-position: -338px -50px;
            border-radius: 8px;
            margin-left: 11px;}
    </style>
    <script src="/js/sweetalert.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
</head>
<body>
<div id="div1">
    <ul>
        <li id="fullScreen">全屏</li>
        <li id="fourScreen">4屏</li>
        <li id="sixScreen">6屏</li>
        <li id="nineScreen">9屏</li>
    </ul>
</div>

<div id="video1" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainOne">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video2" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainTwo">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video3" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainThree">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video4" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainFour">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video5" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainFive">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video6" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainSix">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video7" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainSeven">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video8" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainEight">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
<div id="video9" class="video" ondblclick="exitFullScreen(this);">
    <img src="" id="imageContainNine">
    <div class="footer">
        <span class="lineName"></span>
        <span class="stationName"></span>
        <span class="deviceName"></span>
        <input type="text" class="deviceID" hidden="hidden">
        <input type="text" class="playStatus" hidden="hidden" value="1">
        <input type="button" class="play">
        <input type="button" class="del">
    </div>
</div>
</body>
<script language="JavaScript" src="/js/jquery.js"></script>
<script>
$(document).ready(function () {
    getVideo();

    $("img").error(function () {
        $(this).attr("src", "/images/timg (1).jpg");//JSP页面
    });

    $('.video').click(function(){
        var divClass=this;
        $("#fullScreen").unbind('click').click(function () {
            fullScreen(divClass);
        })
    });

    $("#fourScreen").click(function () {
        $(".video").attr("style","width:49.7%;height:49%;");//设置宽度,高度
        $("#video5,#video6,#video7,#video8,#video9").attr("style","display:none;");//隐藏div
    });

    $("#sixScreen").click(function () {
        $("#video5,#video6").attr("style","display:block;");//隐藏div
        $(".video").attr("style","width:33%;height:49%;");//设置宽度
        $("#video7,#video8,#video9").attr("style","display:none;");//隐藏div
    });

    $("#nineScreen").click(function () {
        $(".video").attr("style","width:33%;");//设置宽度
    });

    $(".del").click(function () {
        var deviceID=$(this).siblings(".deviceID").val();
        if (deviceID==""){
            swal("请先选择需要监看的设备");
        }else{
            window.location.href="/Device/deletePlaylist?deviceID="+deviceID;
        }
    });

    $(".play").click(function () {
        var deviceID=$(this).siblings(".deviceID").val();
        var status=$(this).siblings(".playStatus").val();
        var object=$(this);
        if (deviceID==""){
            swal("请先选择需要监看的设备");
        }else{
            $.ajax({
                url:'/Device/openPlay',
                type:"POST",
                data:{deviceID:deviceID},
                success:function (data) {
                    var divID=object.parent().parent().attr('id');
                    if(status=="1"){
                        if(divID=="video1"){
                            oneStatus=0;
                        }
                        if(divID=="video2"){
                            twoStatus=0;
                        }
                        if(divID=="video3"){
                            threeStatus=0;
                        }
                        if(divID=="video4"){
                            fourStatus=0;
                        }
                        if(divID=="video5"){
                            fiveStatus=0;
                        }
                        if(divID=="video6"){
                            sixStatus=0;
                        }
                        if(divID=="video7"){
                            sevenStatus=0;
                        }
                        if(divID=="video8"){
                            eightStatus=0;
                        }
                        if(divID=="video9"){
                            nineStatus=0;
                        }
                        object.siblings(".playStatus").attr("value",'0');
                        object.attr("style","background-position: 69px -49.7px;");
                    }else{
                        if(divID=="video1"){
                            oneStatus=1;
                        }
                        if(divID=="video2"){
                            twoStatus=1;
                        }
                        if(divID=="video3"){
                            threeStatus=1;
                        }
                        if(divID=="video4"){
                            fourStatus=1;
                        }
                        if(divID=="video5"){
                            fiveStatus=1;
                        }
                        if(divID=="video6"){
                            sixStatus=1;
                        }
                        if(divID=="video7"){
                            sevenStatus=1;
                        }
                        if(divID=="video8"){
                            eightStatus=1;
                        }
                        if(divID=="video9"){
                            nineStatus=1;
                        }
                        object.siblings(".playStatus").attr("value",'1');
                        object.attr("style","background-position: -51px -9px;");
                    }
                    getVideo();
                }
            });
        }
    });
});
//定义全局状态变量
var oneStatus=1;
var twoStatus=1;
var threeStatus=1;
var fourStatus=1;
var fiveStatus=1;
var sixStatus=1;
var sevenStatus=1;
var eightStatus=1;
var nineStatus=1;

function getpos(ev){
    var scrolltop=document.documentElement.scrollTop||document.body.scrollTop;
    var scrollleft=document.documentElement.scrollLeft||document.body.scrollLeft;
    return {x:ev.clientX+scrollleft,y:ev.clientY+scrolltop}

}
window.onload=function(){
    var odiv1=document.getElementById("div1");
    document.oncontextmenu=function(ev){
        var eventr=ev||event;
        var pos=getpos(eventr);
        odiv1.style.top=pos.y+"px";
        odiv1.style.left=pos.x+"px";
        odiv1.style["display"]="block";
        return false;
    };
    document.onclick=function(){
        odiv1.style["display"]="none";
    };
};

function fullScreen(el) {
    var rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullScreen,
        wscript;

    if(typeof rfs != "undefined" && rfs) {
        rfs.call(el);
        return;
    }

    if(typeof window.ActiveXObject != "undefined") {
        wscript = new ActiveXObject("WScript.Shell");
        if(wscript) {
            wscript.SendKeys("{F11}");
        }
    }
}

function exitFullScreen(el) {
    var el= document,
        cfs = el.cancelFullScreen || el.webkitCancelFullScreen || el.mozCancelFullScreen || el.exitFullScreen,
        wscript;

    if (typeof cfs != "undefined" && cfs) {
        cfs.call(el);
        return;
    }

    if (typeof window.ActiveXObject != "undefined") {
        wscript = new ActiveXObject("WScript.Shell");
        if (wscript != null) {
            wscript.SendKeys("{F11}");
        }
    }
}


function changeSrc(nIndex,deviceList){
    if(deviceList.length>=1){
        nIndex++;
        document.getElementById('video1').getElementsByTagName('input')[0].value=deviceList[nIndex%deviceList.length].id;
        document.getElementById('video1').getElementsByTagName('span')[0].innerHTML=deviceList[nIndex%deviceList.length].lineName;
        document.getElementById('video1').getElementsByTagName('span')[1].innerHTML=deviceList[nIndex%deviceList.length].stationName;
        document.getElementById('video1').getElementsByTagName('span')[2].innerHTML=deviceList[nIndex%deviceList.length].name;
        var countOne = 0;
        var onePath=deviceList[nIndex%deviceList.length].id;
        oneTimer =setInterval(function(){
            if(oneStatus==1){
                clearInterval(oneTimer);
                countOne=0;
                return;
            }
            document.getElementById("imageContainOne").src = "/Path/"+onePath+"/"+countOne+".PNG";
            countOne++;
            //deleteImage(document.getElementById("imageContainOne").src);
        },1000);

    }
    if(deviceList.length>=2){
        nIndex++;
        document.getElementById('video2').getElementsByTagName('input')[0].value=deviceList[nIndex%deviceList.length].id;
        document.getElementById('video2').getElementsByTagName('span')[0].innerHTML=deviceList[nIndex%deviceList.length].lineName;
        document.getElementById('video2').getElementsByTagName('span')[1].innerHTML=deviceList[nIndex%deviceList.length].stationName;
        document.getElementById('video2').getElementsByTagName('span')[2].innerHTML=deviceList[nIndex%deviceList.length].name;
        var twoPath=deviceList[nIndex%deviceList.length].id;
        var countOne = 0;
        twoTimer =setInterval(function(){
            if(twoStatus==1){
                clearInterval(twoTimer);
                countOne=0;
                return;
            }
            document.getElementById("imageContainTwo").src = "/Path/"+twoPath+"/"+countOne+".PNG";
            countOne++;
            //deleteImage(document.getElementById("imageContainOne").src);
        },1000);
    }
}

function showVideo(deviceList) {
    var nIndex = 0;
    if(deviceList.length>9){
        objTimer = window.setInterval(function(){
            changeSrc(nIndex,deviceList);
            nIndex++;
        },2000);
    }else{
        changeSrc(nIndex,deviceList);
    }
}

function deleteImage(path) {
    $.ajax({
        url:'/Device/deleteImage',
        type:"POST",
        data:{imagePath:path},
        success:function (data) {
        }
    });
}

function getVideo() {
    $.ajax({
        url:'/Device/getVideo',
        type:"POST",
        data:{},
        success:function (data) {
            var deviceList=data.deviceList;
            showVideo(deviceList);
        }
    });
}
</script>
</html>


